# Day 1 - PenTest Overview, Network Scanning/Recon, Exploit Development

[TOC]

## Penetration Testing Stages

**Phase 1: Mission Definition**

- Define mission goals and targets
- Determine scope of mission
- Define Rules of Engagement

**Phase 2: Recon**

- Information gathering about the target through public sources

**Phase 3: Footprinting**

- Accumulate data through scanning and/or interaction with the target/target resources

Phase 4: Exploitation and Initial Access

- Gain an initial foothold on network

**Phase 5: Post Exploitation** 

- Establish persistence
- Escalate privileges
- Cover your tracks
- Exfiltrate target data

**Phase 6: Document Mission**

- Document and report mission details

------

## Scanning and Reconnaissance

### HTTP

#### HTTP Demo

![image-20251210102829746](Images/image-20251210102829746.png)

When a HTML page is loaded, a DOM or Document Object Module is created. 

![image-20251210102913519](Images/image-20251210102913519.png)

#### Page Source

We can see more information by viewing page source. 

```
Right Click -> View page source
```

![image-20251210102944521](Images/image-20251210102944521.png)

![image-20251210103054568](Images/image-20251210103054568.png)

#### HTTP Enumeration Steps

During Website Recon:

1. Scan it.

   ```bash
   proxychains nmap -sT -Pn 192.168.28.111 -p 80 --script http-enum       # Run the enum HTTP script
   ```

2. Check out robots.txt

3. Browse top to bottom (normally)

4. View page source (href)

5. Scrape Data

#### Scraping Data

'Scraping data' is just finding the important data within a webpage. 

Within quotes.toscrape.com:

![image-20251210103336673](Images/image-20251210103336673.png)

View page source. Then, we search for keywords. 

![image-20251210103407330](Images/image-20251210103407330.png)

In this case, "small class='author'" is a keyword. Keep searching that string for more information.  

We can then run our scrape.py script to find more information: 

```python
#!/usr/bin/python
import lxml.html
import requests

page = requests.get('http://quotes.toscrape.com') # From the example above
tree = lxml.html.fromstring(page.content)

goodstuff = tree.xpath('//small[@class="author"]/text()') # From the example above

print ('Authors: ',goodstuff)
```

![image-20251210103800943](Images/image-20251210103800943.png)

### Advanced Scanning

We need to build a Dynamic tunnel for our scans. 

![image-20251210104334122](Images/image-20251210104334122.png)

#### ping sweep

Used to identify hosts on a connected network

```bash
# On the jump box
for i in {1..254}; do (ping -c 1 192.168.28.$i | grep "bytes from" &) ; done

# Cleaner output ping sweep
for i in {1..254}; do (ping -c 1 192.168.28.$i | grep "bytes from" &) ; done | awk '{ print $4 }' | sed 's/://g' 
```

![image-20251210104815863](Images/image-20251210104815863.png)

TTL help Identify a box based on the ping response:

```bash
128 = windows
64 = some type of nix
60 = mac
255 = solaris
```

#### Scan discovered IPs

To use this method, we input a list of IPs into a file. In the example, the file is "ips". We then proxychain scan using an existing dynamic tunnel and a custom nmap command to use the file a list of IPs. 

```bash
nano ips # Create a file and insert discovered IPs
proxychains nmap -sT -Pn -iL ips --open
```

#### Banner Grab Open Ports

```bash
proxychains nc -vvv 192.168.28.120 4242
```

![image-20251210110025857](Images/image-20251210110025857.png)

#### nmap nse (scripting)

We can use nmap scripts to speed up our scanning. They are located within:

```bash
/usr/share/nmap/scripts/
```

![image-20251210110415067](Images/image-20251210110415067.png)

Search for a specific script:

```bash
ls /usr/share/nmap/scripts/ | grep ftp
```

![image-20251210110503124](Images/image-20251210110503124.png)

nmap script help page:

```bash
nmap --script help
nmap --script-help /usr/share/nmap/scripts/ftp-anon # Example
```

![image-20251210110622825](Images/image-20251210110622825.png)

##### http.enum

```bash
nmap --script-help http-enum.nse # HTTP Enumeration script
```

##### smb-os-discovery

```bash
nmap -sT -Pn X.X.X.X -p 445 --script smb-os-discovery
```

